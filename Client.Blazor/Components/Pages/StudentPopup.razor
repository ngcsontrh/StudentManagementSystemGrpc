@using Client.Blazor.Models
@using Microsoft.AspNetCore.Components
@using Shared
@rendermode InteractiveServer

<Drawer Visible="@IsVisible" Placement="right" Title="@("Update Student")" OnClose="ClosePopup" Width="500">
    <Form Model="@StudentProfile"
          OnFinish="@(Status == "Update" ? UpdateStudent : Status == "Create" ? CreateStudent: async () => {})"
          ValidateMode=@FormValidateMode.Complex
          RequiredMark=FormRequiredMark.Required>
        @if(Status == "Details" || Status == "Update")
        {
            <FormItem Label="ID">
                <Input @bind-Value="StudentProfile.Id" Disabled />
            </FormItem>
        }
        <FormItem Label="Full Name">
            <Input @bind-Value="StudentProfile.FullName" Disabled=@(Status == "Details")/>
        </FormItem>
        <FormItem Label="Birthday">
            <DatePicker @bind-Value="StudentProfile.Birthday" Format="dd/MM/yyyy" Disabled=@(Status == "Details") DefaultValue="DateTime.Now" />
        </FormItem>
        <Flex Gap="small">
            <FormItem Label="Class">
                <Select DataSource="@classes"
                        @bind-Value="@context.ClassId"
                        ItemValue="c => c.Id"
                        ItemLabel="c => c.Name"
                        Style="width: 120px"
                        Disabled=@(Status == "Details")>
                </Select>
            </FormItem>
            <FormItem Label="Class Subject">
                <Select DataSource="@classes"
                        @bind-Value="@context.ClassId"
                        ItemValue="c => c.Id"
                        ItemLabel="c => c.Subject"
                        Disabled>
                </Select>
            </FormItem>
        </Flex>
        <FormItem Label="Address">
            <TextArea @bind-Value="StudentProfile.Address" MinRows="3" MaxRows="6" Disabled=@(Status == "Details") />
        </FormItem>
        @if (Status == "Details")
        {
            <FormItem Label="Teacher ID">
                <Input @bind-Value="StudentProfile.TeacherId" Disabled />
            </FormItem>
            <FormItem Label="Teacher Name">
                <Input @bind-Value="StudentProfile.TeacherFullName" Disabled/>
            </FormItem>
            <FormItem Label="Teacher Birthday">
                <Input @bind-Value="StudentProfile.TeacherBirthday" Disabled />
            </FormItem>
        }       
        <FormItem>
            <Button Disabled=@(Status == "Details") Type="primary" HtmlType="submit">@Status</Button>
        </FormItem>
    </Form>
</Drawer>